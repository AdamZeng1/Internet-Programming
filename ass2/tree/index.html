<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Page Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="jqtree.css">
    <script src="jquery.min.js"></script>
    <script src="tree.jquery.js"></script>

</head>
<body>
    <p id="demo"></p>
        <div id="tree1"></div>

<script>

// Read xml file
var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
    // Read data from xml and store to js vector
        var data = myFunction(this); 

              //dispaly data on the tree
              $(function() {
                $('#tree1').tree({
                    data: data
                    
                });
            });
}
};
xhttp.open("GET", "../xml/categories.xml", true);
xhttp.send();

function myFunction(xml) {
  var data = [];
  var xmlDoc = xml.responseXML;
  var x = xmlDoc.getElementsByTagName("Categories");

  // To store categores
  for (let index = 0; index < x.length; index++) {

    //description of categories
    var str = x[index].getElementsByTagName("Description")[0].childNodes[0].nodeValue;
    var arr = str.split(",");
    var children = [];
    for (let j = 0; j < arr.length; j++) {
        var child = {};
        child.name =  arr[j];
        children.push(child);
             
    }

    var obj = new Object();
    obj.name = x[index].getElementsByTagName("CategoryName")[0].childNodes[0].nodeValue;
    obj.children = children;

    data.push(obj);

  }

  return data;

}

    $('#tree1').on(
        'tree.select',
        function (event) {
            if (event.node) {
                // node was selected
                var node = event.node;
                if (node.children.length > 0) {
                    //This is parents node, display descriptions from categories.xml
                    clickParentNode(node.name);
                    //alert(node.name + "This is parent node");

                } else {
                    //This is parents node, display price and QuantityPerUnit from products.xml
                    alert(node.name + "This is child node");
                }
               
            }
            else {
                // event.node is null
                // a node was deselected
                // e.previous_node contains the deselected node
            }
        }
    );


    function clickParentNode(nodeName) {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                // Read data from xml and store to js vector
                getDescription(this, nodeName);


            }
        };
        xhttp.open("GET", "../xml/categories.xml", true);
        xhttp.send();
    }

    //get description
    function getDescription(xml, ParentNodeName)
    {
      
        var xmlDoc = xml.responseXML;
        var x = xmlDoc.getElementsByTagName("Categories");
        // To store categores
        for (let index = 0; index < x.length; index++)
        {
            //description of categories
            var str = x[index].getElementsByTagName("CategoryName")[0].childNodes[0].nodeValue;
            if (str == ParentNodeName) {
                var currentnode = x[index].getElementsByTagName("Description")[0].childNodes[0];
                var des = "Description: " + currentnode.nodeValue;
                
                alert(des);
            }
        }

    }


</script>
</body>
</html>